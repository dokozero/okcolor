"use strict";let o="fill",a=!1,S={hasFillStroke:{fill:!1,stroke:!1},colors:{fill:{r:255,g:255,b:255,opacity:0},stroke:{r:255,g:255,b:255,opacity:0}}},l=JSON.parse(JSON.stringify(S));function c(){l=JSON.parse(JSON.stringify(S));let s=["CODE_BLOCK","COMPONENT_SET","CONNECTOR","DOCUMENT","EMBED","GROUP","LINK_UNFURL","MEDIA","PAGE","SHAPE_WITH_TEXT","SLICE","STAMP","STICKY","WIDGET"],e=figma.currentPage.selection[0];if(e===void 0)return f("noSelection"),!1;for(const i of figma.currentPage.selection)if(s.includes(i.type))return f("notSupportedType",i.type),!1;let r="",t="";if(e.fills[0]!==void 0&&(r=e.fills[0].type,r=="SOLID"&&(l.hasFillStroke.fill=!0,l.hasFillStroke.fill=!0,l.colors.fill.r=e.fills[0].color.r*255,l.colors.fill.g=e.fills[0].color.g*255,l.colors.fill.b=e.fills[0].color.b*255,l.colors.fill.opacity=Math.round(e.fills[0].opacity*100))),e.strokes[0]!==void 0&&(t=e.strokes[0].type,t=="SOLID"&&(l.hasFillStroke.stroke=!0,l.hasFillStroke.stroke=!0,l.colors.stroke.r=e.strokes[0].color.r*255,l.colors.stroke.g=e.strokes[0].color.g*255,l.colors.stroke.b=e.strokes[0].color.b*255,l.colors.stroke.opacity=Math.round(e.strokes[0].opacity*100))),r!="SOLID"&&t!="SOLID"&&(e.fills[0]!==void 0||e.strokes[0]!==void 0))return f("noSolidColor"),!1;if(!l.hasFillStroke.fill&&!l.hasFillStroke.stroke)return f("noColorInShape"),!1;if(figma.currentPage.selection.length>1){let i=0,k=0;for(const u of figma.currentPage.selection)u.fills[0]!==void 0&&i++,u.strokes[0]!==void 0&&k++;if(figma.currentPage.selection.length!=i&&figma.currentPage.selection.length!=k)return f("notAllShapesHaveFillOrStroke"),!1}return!0}function n(s=!1){figma.ui.postMessage({shapeInfos:l,currentFillOrStroke:o,shouldRenderColorPickerCanvas:s,message:"new shape color"})}function f(s,e=""){figma.ui.postMessage({message:"Display UI Message",UIMessageCode:s,nodeType:e})}figma.showUI(__html__,{width:240,height:346,themeColors:!0});function g(){c()&&(l.hasFillStroke.fill?o="fill":o="stroke",n(!0))}g();figma.on("selectionchange",()=>{c()&&(o=="fill"&&!l.hasFillStroke.fill?o="stroke":o=="stroke"&&!l.hasFillStroke.stroke&&(o="fill"),n(!0))});figma.on("documentchange",s=>{if(s.documentChanges[0].type=="PROPERTY_CHANGE"&&!a){const r=s.documentChanges[0].properties[0];if(r=="fills"||r=="strokes"){let t=Object.assign({},l.hasFillStroke);if(!c())return;if(JSON.stringify(t)!==JSON.stringify(l.hasFillStroke)){o=="fill"&&!l.hasFillStroke.fill?o="stroke":o=="stroke"&&!l.hasFillStroke.stroke&&(o="fill"),n(!0);return}o=="fill"&&r=="strokes"||o=="stroke"&&r=="fills"?n():n(!0)}}a&&(a=!1)});figma.ui.onmessage=s=>{if(s.type=="Update shape color"){a=!0;for(const e of figma.currentPage.selection){let r;"fills"in e&&o=="fill"?r=JSON.parse(JSON.stringify(e.fills)):"strokes"in e&&o=="stroke"&&(r=JSON.parse(JSON.stringify(e.strokes))),r[0].color.r=s.newColor.r/255,r[0].color.g=s.newColor.g/255,r[0].color.b=s.newColor.b/255,r[0].opacity=s.newColor.opacity/100,"fills"in e&&o=="fill"?e.fills=r:"strokes"in e&&o=="stroke"&&(e.strokes=r)}}else s.type=="Sync currentFillOrStroke"&&(o=s.currentFillOrStroke)};
